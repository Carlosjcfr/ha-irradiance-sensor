# Irradiance Sensor para Home Assistant

Este componente personalizado permite integrar sensores de irradiancia, temperatura y viento en Home Assistant a trav√©s de Modbus TCP o RS485 (Serial). Dise√±ado para ser flexible, permite configurar modelos predefinidos o mapear registros personalizados paso a paso.

## ‚ú® Caracter√≠sticas

*   **Soporte Dual**: Conexi√≥n v√≠a Modbus TCP (IP) o Modbus RTU (RS485/Serial).
*   **M√∫ltiples Sensores**: Lectura de:
    *   Irradiancia (W/m¬≤)
    *   Temperatura Externa e Interna (¬∞C)
    *   Velocidad del Viento (m/s)
    *   Direcci√≥n del Viento (¬∞)
*   **Configuraci√≥n Guiada**: Asistente de configuraci√≥n paso a paso para definir direcciones, ganancias y offsets.
*   **Plantillas**: Guarda tus configuraciones como plantillas para reutilizarlas en el futuro.
*   **Gesti√≥n de Errores**: Validaciones de conexi√≥n y par√°metros.

## üöÄ Instalaci√≥n

### Opci√≥n 1: V√≠a HACS (Recomendado)

1.  Aseg√∫rate de tener [HACS](https://hacs.xyz/) instalado.
2.  Ve a **HACS** > **Integraciones**.
3.  Men√∫ (tres puntos arriba a la derecha) > **Repositorios personalizados**.
4.  A√±ade la URL del repositorio: `https://github.com/Carlosjcfr/ha-irradiance-sensor`.
5.  Categor√≠a: **Integraci√≥n**.
6.  Pulsa **A√±adir** y luego busca "Irradiance Sensor" para instalarlo.
7.  **Reinicia Home Assistant**.

### Opci√≥n 2: Manual

1.  Descarga el c√≥digo fuente.
2.  Copia la carpeta `custom_components/irradiance_sensor` en tu directorio `config/custom_components/`.
3.  Reinicia Home Assistant.

## ‚öôÔ∏è Configuraci√≥n

Una vez instalado y reiniciado:

1.  Ve a **Ajustes** > **Dispositivos y servicios**.
2.  Pulsa **A√±adir integraci√≥n** y busca **Irradiance Sensor**.
3.  **Paso 1: Conexi√≥n**
    *   Selecciona **Modbus TCP** o **RS485**.
    *   Introduce los datos de conexi√≥n (IP/Puerto o Puerto Serie/Baudrate).
    *   Selecciona un **Modelo de Sensor** (o usa el Generico/Personalizado).
4.  **Paso 2: Mapeo de Par√°metros**
    *   El asistente te guiar√° par√°metro por par√°metro (Irradiancia, Temperaturas, etc.).
    *   Para cada uno puedes definir:
        *   **Nombre**: Alias amigable.
        *   **Direcci√≥n (Addr)**: Registro Modbus.
        *   **Ganancia (Gain)**: Multiplicador (ej. 0.1 para convertir 123 en 12.3).
        *   **Offset**: Valor a sumar/restar.
5.  **Paso 3: Finalizar**
    *   Define el nombre de la entidad en Home Assistant.
    *   (Opcional) Guarda la configuraci√≥n actual como una nueva plantilla.

## üõ†Ô∏è Soluci√≥n de Problemas

*   **Error de conexi√≥n**: Verifica que la IP/Puerto sean correctos y que el dispositivo Modbus est√© accesible.
*   **Lecturas err√≥neas**: Revisa la *Ganancia* y el *Offset* en la configuraci√≥n. Muchos sensores env√≠an valores enteros que requieren un factor de escala (ej. Gain 0.1).

## Cr√©ditos

Desarrollado para facilitar la integraci√≥n de estaciones meteorol√≥gicas y piran√≥metros solares en Home Assistant.
